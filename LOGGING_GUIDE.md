# 📊 Trading Bot Logging System

## 🎯 Overview

The Trading Bot now includes a comprehensive logging system that captures all activities, errors, and performance metrics. This helps you monitor the bot's behavior, debug issues, and track trading performance.

## 📁 Log Files

### Main Log File
- **Location**: `logs/tradingbot.log`
- **Rotation**: Automatically rotates when file reaches 10MB
- **Retention**: Keeps 30 days of historical logs
- **Format**: Structured format with timestamps and log levels

### Log Levels
- **ERROR**: Critical errors and exceptions
- **WARN**: Warning messages and potential issues
- **INFO**: Important events and trade executions
- **DEBUG**: Detailed debugging information

## 🔍 Log Categories

### 1. Application Lifecycle
```
🔄 APPLICATION LIFECYCLE
⏰ Time: 2024-01-15 10:30:45.123
📅 Event: Application Started
📝 Details: Dual Strategy Scheduler initialized
```

### 2. Strategy Execution
```
🎯 STRATEGY 1 EXECUTION #5 - 2024-01-15 10:30:45
📊 Strategy: 200-Day MA + Trendline Breakout
📈 Risk-Reward: 6:1 (Conservative)
```

### 3. Trade Signals
```
🚨 STRATEGY 1 SIGNAL DETECTED: 1 signals for BTCUSD
🚨 STRATEGY 1 SIGNAL: BUY BTCUSD at $65432.10
```

### 4. Trade Execution
```
📊 TRADE EXECUTION LOG
⏰ Time: 2024-01-15 10:30:45.123
🎯 Strategy: Strategy 1
💰 Symbol: BTCUSD
📈 Type: BUY
💵 Entry: $65432.10
🛡️ Stop Loss: $63000.00
🎯 Take Profit: $72000.00
📝 Reason: 200-Day MA Breakout
✅ Status: OPENED
```

### 5. Database Operations
```
🗄️ DATABASE OPERATION
⏰ Time: 2024-01-15 10:30:45.123
🔧 Operation: INSERT
📊 Table: trades
📝 Details: New trade created for BTCUSD
⚡ Duration: 45ms
```

### 6. API Calls
```
🌐 API CALL LOG
⏰ Time: 2024-01-15 10:30:45.123
✅ Status: 200
🔗 Endpoint: /v2/history/candles
📡 Method: GET
⚡ Duration: 234ms
📝 Details: Retrieved 250 candles for BTCUSD
```

### 7. Errors with Context
```
❌ ERROR WITH CONTEXT
⏰ Time: 2024-01-15 10:30:45.123
📍 Context: DualStrategySchedulerService
🔧 Operation: fetchPrice
💥 Error: Connection timeout
📝 Additional Info: Delta Exchange API unavailable
🔍 Stack Trace:
java.net.SocketTimeoutException: Read timed out
    at com.tradingbot.service.CryptoPriceService.getBitcoinPrice()
    ...
```

### 8. Notifications
```
📱 NOTIFICATION LOG
⏰ Time: 2024-01-15 10:30:45.123
✅ Status: SUCCESS
📧 Type: Telegram Alert
👤 Recipient: Trading Bot Channel
📝 Details: Strategy 1 BUY signal for BTCUSD
```

## 🛠️ Monitoring Tools

### 1. Log Monitor Script
Use the provided `monitor_logs.bat` script to monitor logs:

```bash
# Run the log monitor
monitor_logs.bat
```

**Features:**
- View recent logs (last 50 lines)
- Real-time log monitoring
- Search for errors
- Search for trading signals
- Search for specific text
- View log file statistics

### 2. PowerShell Commands

#### View Recent Logs
```powershell
Get-Content logs\tradingbot.log -Tail 50
```

#### Monitor Logs in Real-Time
```powershell
Get-Content logs\tradingbot.log -Wait -Tail 10
```

#### Search for Errors
```powershell
Select-String -Path logs\tradingbot.log -Pattern "ERROR|Exception|Failed|❌" -Context 2
```

#### Search for Trading Signals
```powershell
Select-String -Path logs\tradingbot.log -Pattern "SIGNAL|Strategy.*EXECUTION|position opened" -Context 1
```

#### Get Log Statistics
```powershell
$content = Get-Content logs\tradingbot.log
Write-Host "Total Lines:" $content.Count
Write-Host "Error Count:" ($content | Select-String -Pattern "ERROR|Exception").Count
Write-Host "Warning Count:" ($content | Select-String -Pattern "WARN").Count
Write-Host "Info Count:" ($content | Select-String -Pattern "INFO").Count
```

## 📊 Log Analysis Examples

### 1. Check Strategy Performance
```powershell
# Count signals generated by each strategy
Select-String -Path logs\tradingbot.log -Pattern "STRATEGY.*EXECUTION" | Group-Object {($_ -split "STRATEGY ")[1] -split " EXECUTION" | Select-Object -First 1} | Select-Object Name, Count
```

### 2. Monitor Error Patterns
```powershell
# Group errors by type
Select-String -Path logs\tradingbot.log -Pattern "ERROR.*:" | ForEach-Object { ($_ -split "ERROR.*: ")[1] } | Group-Object | Sort-Object Count -Descending
```

### 3. Track Trade Execution Times
```powershell
# Find trade execution logs
Select-String -Path logs\tradingbot.log -Pattern "TRADE EXECUTION LOG" -Context 10
```

### 4. Monitor API Performance
```powershell
# Find slow API calls (over 1000ms)
Select-String -Path logs\tradingbot.log -Pattern "Duration: \d{4,}ms"
```

## 🔧 Configuration

### Log Level Configuration
The logging levels are configured in `application.properties`:

```properties
# Main application logging
logging.level.com.tradingbot=INFO

# Detailed service logging
logging.level.com.tradingbot.service.DualStrategySchedulerService=DEBUG
logging.level.com.tradingbot.service.EMAStrategy=DEBUG
logging.level.com.tradingbot.service.MovingAverageStrategy=DEBUG
logging.level.com.tradingbot.service.PositionManagementService=DEBUG
logging.level.com.tradingbot.service.Strategy2PositionService=DEBUG
logging.level.com.tradingbot.service.DeltaCandlestickService=DEBUG
logging.level.com.tradingbot.service.CryptoPriceService=DEBUG

# Database logging
logging.level.org.springframework.jdbc=DEBUG
logging.level.org.hibernate.SQL=DEBUG
```

### File Logging Settings
```properties
# Log file configuration
logging.file.name=logs/tradingbot.log
logging.file.max-size=10MB
logging.file.max-history=30
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
```

## 🚨 Troubleshooting

### Common Issues

#### 1. Log File Not Created
- **Cause**: Application hasn't started yet
- **Solution**: Start the application first

#### 2. No Logs Being Written
- **Cause**: Log level too high or logging disabled
- **Solution**: Check `application.properties` logging configuration

#### 3. Large Log Files
- **Cause**: Debug logging enabled in production
- **Solution**: Change log levels to INFO or WARN for production

#### 4. Missing Error Details
- **Cause**: Exception stack traces not being logged
- **Solution**: Ensure ERROR level logging is enabled

### Performance Considerations

#### 1. Disk Space
- Log files can grow large with DEBUG logging
- Monitor disk space regularly
- Consider log rotation settings

#### 2. I/O Performance
- File logging can impact performance
- Consider async logging for high-frequency operations
- Monitor log file write performance

#### 3. Memory Usage
- Large log buffers can consume memory
- Adjust buffer sizes based on available memory

## 📈 Best Practices

### 1. Log Level Strategy
- **Development**: Use DEBUG level for detailed troubleshooting
- **Production**: Use INFO level for normal operation
- **Monitoring**: Use WARN/ERROR levels for alerts

### 2. Log Message Format
- Use structured format with consistent fields
- Include relevant context (symbol, strategy, price)
- Use emojis for easy visual scanning

### 3. Error Logging
- Always include full stack traces for errors
- Add context about what operation was being performed
- Include relevant data (prices, symbols, etc.)

### 4. Performance Monitoring
- Log execution times for critical operations
- Monitor API response times
- Track database operation performance

### 5. Security Considerations
- Avoid logging sensitive information (API keys, passwords)
- Be careful with user data in logs
- Consider log file permissions

## 🔄 Log Rotation and Cleanup

The logging system automatically handles:
- **File Rotation**: When log file reaches 10MB
- **History Retention**: Keeps 30 days of historical logs
- **Compression**: Older log files are compressed
- **Cleanup**: Old files are automatically deleted

## 📞 Support

If you encounter issues with logging:
1. Check the log file permissions
2. Verify disk space availability
3. Review logging configuration in `application.properties`
4. Use the `monitor_logs.bat` script for troubleshooting
5. Check application startup logs for configuration errors

---

**Happy Trading! 📊🚀**
